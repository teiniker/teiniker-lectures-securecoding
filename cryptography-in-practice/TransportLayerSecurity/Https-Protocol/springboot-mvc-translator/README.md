# Spring Boot MVC  

Spring MVC is a module of the Spring framework dealing with the **Model-View-Controller (MVC)** 
pattern.

Spring implements MVC with the **Front Controller** pattern using its `DispatcherServlet`.

The `DispatcherServlet` acts as the main **controller** to route requests to their intended 
destination. 
**Model** is nothing but the data of our application, and the **view** is represented by a template 
engine.

## Application Entry Point 

```Java
@SpringBootApplication
public class Application
{
    public static void main(String[] args)
    {
        SpringApplication.run(Application.class, args);
    }
}
```

## Controller 

```Java
@Controller
public class TranslatorController 
{
  @PostMapping("/translator")
  public String translate(
          @RequestParam(name = "language") String language, 
          @RequestParam(name = "word") String word, Model model) {
    //...
    model.addAttribute("word", word);
    model.addAttribute("translation", translation);
    return "translation";
  }
  // ...
}
```
* **@Controller**: This annotation serves as a specialization of `@Component`, allowing for 
  implementation classes to be autodetected through classpath scanning. 
  It is typically used in combination with annotated handler methods based on the
  `RequestMapping` annotation.
* **@GetMapping**: Annotation for mapping `HTTP GET` requests onto specific handler methods.
  `@GetMapping` is a composed annotation that acts as a shortcut for `@RequestMapping(method = RequestMethod.GET)`.
* **@PostMapping**: Annotation for mapping `HTTP POST` requests onto specific handler methods.
  `@GetMapping` is a composed annotation that acts as a shortcut for `@RequestMapping(method = RequestMethod.POST)`.
* **@RequestParam**: Annotation which indicates that a method parameter should be bound to a web request parameter.

The **Model** object is used to store data which should be forwarded to the view template.
The returned string `"translation"` will be used to load the `translation.html` template.

## View Template 

The view uses a template engine called **Thymeleaf**. 
Each template contains HTML code and tags like `${word}` which are replaced by the model entities.

```HTML
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Translation Application</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
    <h2>
        <p th:text="'Translate: ' + ${word} + ' into ' + ${translation}" />
    </h2>
    <p/>
    <a href="index.html"> back</a>
</body>
</html>
```

## Build and Run

We build and run the application like any Spring-Boot application:
```
$ mvn spring-boot:run 
```
Also, a fat JAR can be generated by Maven's `package` target:
```
$ mvn clean package
$ java -jar target/springboot-mvc-translator-0.0.1-SNAPSHOT.jar
```

## Accessing the Web Application

The running web application can be accessed by a browser or a command line tool:
```
URL: http://localhost:8080/index.html

$ curl -v http://localhost:8080/index.html

$ curl -i -X POST -d 'word=cat&language=Deutsch&action=Translate' http://localhost:8080/translator
```

If we use an **interception proxy** we have to modify the `curl` commands:
```
$ curl -k -v --proxy http://localhost:8010 https://localhost:8443/index.html

$ curl -k -i --proxy http://localhost:8010 -X POST -d 'word=cat&language=Deutsch&action=Translate' https://localhost:8443/translator
```
Using the **Manual Explore** option of ZAP, we can work with the browser while
the interception proxy is recording the communication.

```
URL: http://localhost:8080/index.html
``

## Resources

* [Serving Web Content with Spring MVC](https://spring.io/guides/gs/serving-web-content/)

* [Baeldung: Spring MVC Tutorial](https://www.baeldung.com/spring-mvc-tutorial)
* [Spring RequestMapping](https://www.baeldung.com/spring-requestmapping)

* Mark Heckler. **Spring Boot: Up and Running**. O'Reilly, 2021
  * Chapter 7. Creating Applications Using Spring MVC


*Egon Teiniker, 2020 - 2022, GPL v3.0*